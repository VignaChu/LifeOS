import{_ as Q,k as W,o as r,c as V,a as l,w as t,H as S,r as u,i as _,g as s,s as c,f as i,F as h,q as A,x as m,G as C,E as w}from"./index-B4i_qWUx.js";const X={class:"llm-page"},Y={class:"card-header"},Z={class:"header-right"},$={class:"card-header"},ee={key:0,class:"test-result"},le={class:"usage-stats"},te={class:"stat-item"},ae={class:"stat-value"},oe={class:"stat-item"},se={class:"stat-value"},ne={class:"stat-item"},ue={class:"stat-value"},de={class:"stat-item"},re={class:"stat-value"},ie={__name:"LLM",setup(me){const o=_({provider:"openai",model:"gpt-3.5-turbo",apiKey:"",baseUrl:"",temperature:.7,maxTokens:2e3,useLocalRules:!1}),U=_("今天花了50元吃午饭，心情不错"),d=_(null),k=_(!1),g=_("loading"),b=_({todayCalls:0,monthCalls:0,avgResponseTime:0,successRate:100}),B=a=>({expense:"danger",mood:"warning",event:"success",diary:"info"})[a]||"info",I=a=>({expense:"消费",mood:"情绪",event:"事件",diary:"日记"})[a]||a,M=a=>a>=5?"success":a>=0?"info":a>=-5?"warning":"danger",T=()=>{const a=o.value.apiKey&&o.value.apiKey.trim().length>0&&!o.value.apiKey.includes("dummy"),e=o.value.useLocalRules;a||e?g.value="configured":g.value="not_configured"},P=async()=>{try{const a=await S.getConfig();if(a.success&&a.data){const e={...a.data,baseUrl:a.data.apiUrl||a.data.baseUrl||""};o.value={...o.value,...e}}}catch(a){console.error("加载配置失败:",a)}finally{T()}},E=async()=>{try{const a={...o.value,apiUrl:o.value.baseUrl};await S.saveConfig(a),T(),w.success("配置已保存")}catch{w.error("保存失败")}},N=async()=>{k.value=!0;try{await new Promise(a=>setTimeout(a,1500)),d.value={recordTypes:["expense","mood"],amount:50,emotionScore:5,tags:["餐饮","午餐"],summary:"午餐消费50元，心情愉快"},w.success("连接测试成功")}catch{w.error("连接测试失败")}finally{k.value=!1}};return W(()=>{P()}),(a,e)=>{const v=u("el-tag"),D=u("Check"),L=u("el-icon"),R=u("el-button"),f=u("el-input"),p=u("el-form-item"),F=u("el-slider"),q=u("el-input-number"),z=u("el-switch"),G=u("el-form"),x=u("el-card"),K=u("el-col"),H=u("Connection"),j=u("el-divider"),y=u("el-descriptions-item"),J=u("el-descriptions"),O=u("el-row");return r(),V("div",X,[l(O,{gutter:20},{default:t(()=>[l(K,{span:12},{default:t(()=>[l(x,{shadow:"hover"},{header:t(()=>[s("div",Y,[e[12]||(e[12]=s("span",null,"LLM 配置",-1)),s("div",Z,[g.value==="configured"?(r(),c(v,{key:0,type:"success"},{default:t(()=>[...e[8]||(e[8]=[i("已配置",-1)])]),_:1})):g.value==="not_configured"?(r(),c(v,{key:1,type:"warning"},{default:t(()=>[...e[9]||(e[9]=[i("未配置",-1)])]),_:1})):(r(),c(v,{key:2,type:"info"},{default:t(()=>[...e[10]||(e[10]=[i("检测中...",-1)])]),_:1})),l(R,{type:"primary",onClick:E,style:{"margin-left":"10px"}},{default:t(()=>[l(L,null,{default:t(()=>[l(D)]),_:1}),e[11]||(e[11]=i(" 保存配置 ",-1))]),_:1})])])]),default:t(()=>[l(G,{model:o.value,"label-width":"100px"},{default:t(()=>[l(p,{label:"供应商"},{default:t(()=>[l(f,{modelValue:o.value.provider,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.provider=n),placeholder:"例如: openai, claude, gemini"},null,8,["modelValue"])]),_:1}),l(p,{label:"模型"},{default:t(()=>[l(f,{modelValue:o.value.model,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.model=n),placeholder:"例如: gpt-3.5-turbo, gpt-4"},null,8,["modelValue"])]),_:1}),l(p,{label:"API Key"},{default:t(()=>[l(f,{modelValue:o.value.apiKey,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.apiKey=n),type:"password","show-password":"",placeholder:"输入您的 API Key"},null,8,["modelValue"])]),_:1}),l(p,{label:"Base URL"},{default:t(()=>[l(f,{modelValue:o.value.baseUrl,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.baseUrl=n),placeholder:"可选，自定义 API 地址"},null,8,["modelValue"])]),_:1}),l(p,{label:"温度"},{default:t(()=>[l(F,{modelValue:o.value.temperature,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.temperature=n),min:0,max:2,step:.1,"show-input":""},null,8,["modelValue"]),e[13]||(e[13]=s("div",{class:"form-tip"},"较低的值使输出更确定，较高的值使输出更随机",-1))]),_:1}),l(p,{label:"最大 Token"},{default:t(()=>[l(q,{modelValue:o.value.maxTokens,"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.maxTokens=n),min:100,max:4e3,step:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(p,{label:"使用本地规则"},{default:t(()=>[l(z,{modelValue:o.value.useLocalRules,"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.useLocalRules=n),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"]),e[14]||(e[14]=s("div",{class:"form-tip"},"开启后将无视 API Key，直接使用本地规则解析（无需联网）",-1))]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),l(K,{span:12},{default:t(()=>[l(x,{shadow:"hover",class:"test-card"},{header:t(()=>[s("div",$,[e[16]||(e[16]=s("span",null,"接口测试",-1)),l(R,{type:"primary",onClick:N,loading:k.value},{default:t(()=>[l(L,null,{default:t(()=>[l(H)]),_:1}),e[15]||(e[15]=i(" 测试连接 ",-1))]),_:1},8,["loading"])])]),default:t(()=>[l(f,{modelValue:U.value,"onUpdate:modelValue":e[7]||(e[7]=n=>U.value=n),type:"textarea",rows:4,placeholder:"输入测试文本，例如：今天花了50元吃午饭，心情不错"},null,8,["modelValue"]),d.value?(r(),V("div",ee,[l(j),e[17]||(e[17]=s("h4",null,"解析结果",-1)),l(J,{column:1,border:""},{default:t(()=>[l(y,{label:"类型"},{default:t(()=>[(r(!0),V(h,null,A(d.value.recordTypes,n=>(r(),c(v,{key:n,class:"type-tag",type:B(n)},{default:t(()=>[i(m(I(n)),1)]),_:2},1032,["type"]))),128))]),_:1}),d.value.amount?(r(),c(y,{key:0,label:"金额"},{default:t(()=>[i(" ¥"+m(d.value.amount),1)]),_:1})):C("",!0),d.value.emotionScore!==null?(r(),c(y,{key:1,label:"情绪分"},{default:t(()=>[l(v,{type:M(d.value.emotionScore)},{default:t(()=>[i(m(d.value.emotionScore>0?"+":"")+m(d.value.emotionScore),1)]),_:1},8,["type"])]),_:1})):C("",!0),l(y,{label:"标签"},{default:t(()=>[(r(!0),V(h,null,A(d.value.tags,n=>(r(),c(v,{key:n,size:"small",class:"tag-item"},{default:t(()=>[i(m(n),1)]),_:2},1024))),128))]),_:1}),l(y,{label:"摘要"},{default:t(()=>[i(m(d.value.summary),1)]),_:1})]),_:1})])):C("",!0)]),_:1}),l(x,{shadow:"hover",style:{"margin-top":"20px"}},{header:t(()=>[...e[18]||(e[18]=[s("div",{class:"card-header"},[s("span",null,"使用统计")],-1)])]),default:t(()=>[s("div",le,[s("div",te,[e[19]||(e[19]=s("div",{class:"stat-label"},"今日调用次数",-1)),s("div",ae,m(b.value.todayCalls),1)]),s("div",oe,[e[20]||(e[20]=s("div",{class:"stat-label"},"本月调用次数",-1)),s("div",se,m(b.value.monthCalls),1)]),s("div",ne,[e[21]||(e[21]=s("div",{class:"stat-label"},"平均响应时间",-1)),s("div",ue,m(b.value.avgResponseTime)+"ms",1)]),s("div",de,[e[22]||(e[22]=s("div",{class:"stat-label"},"成功率",-1)),s("div",re,m(b.value.successRate)+"%",1)])])]),_:1})]),_:1})]),_:1})])}}},ce=Q(ie,[["__scopeId","data-v-1d753080"]]);export{ce as default};
