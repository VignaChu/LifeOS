import{_ as Y,k as Z,o as b,c as h,a as l,w as t,I as k,E as u,r as i,i as c,z as ee,g as n,f as r,A as le,s as w,d as _,J as N,x,G as B,K as te,L as ae,M as se,N as oe,C as ne,j as ie,B as re}from"./index-IacY0sFn.js";const de={class:"playlists-container"},ue={class:"card-header"},me={class:"header-left"},pe={class:"playlist-name"},fe={class:"emotion-range"},ce={class:"emotion-slider-container"},_e={class:"emotion-values"},ye={class:"form-tip"},ge={__name:"Playlists",setup(ve){const D=c([]),V=c(!1),m=c(!1),y=c(!1),I=c(!1),P=c(null),a=ie({id:null,name:"",neteasePlaylistId:"",description:"",emotionMin:-10,emotionMax:10,isDefault:!1}),E=re({get:()=>[a.emotionMin,a.emotionMax],set:o=>{a.emotionMin=o[0],a.emotionMax=o[1]}}),R={name:[{required:!0,message:"请输入歌单名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],neteasePlaylistId:[{required:!0,message:"请输入网易云歌单ID",trigger:"blur"}],description:[{max:255,message:"描述不能超过255个字符",trigger:"blur"}]},M=o=>o>=5?"success":o>=0?"info":o>=-5?"warning":"danger",C=async()=>{V.value=!0;try{const o=await k.getPlaylists();o.success&&(D.value=o.data||[])}catch(o){u.error("加载歌单失败："+o.message)}finally{V.value=!1}},U=()=>{y.value=!1,q(),m.value=!0},F=o=>{y.value=!0,Object.assign(a,o),m.value=!0},T=async o=>{try{await ne.confirm(`确定要删除歌单 "${o.name}" 吗？`,"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"});const e=await k.deletePlaylist(o.id);e.success?(u.success("删除成功"),C()):u.error(e.message||"删除失败")}catch(e){e!=="cancel"&&u.error("删除失败："+e.message)}},$=async()=>{var e;if(await((e=P.value)==null?void 0:e.validate().catch(()=>!1))){if(a.emotionMin>a.emotionMax){u.error("最小情绪值不能大于最大情绪值");return}I.value=!0;try{const d=await(y.value?()=>k.updatePlaylist(a.id,a):()=>k.createPlaylist(a))();d.success?(u.success(y.value?"更新成功":"添加成功"),m.value=!1,C()):u.error(d.message||"操作失败")}catch(g){u.error("操作失败："+g.message)}finally{I.value=!1}}},q=()=>{var o;a.id=null,a.name="",a.neteasePlaylistId="",a.description="",a.emotionMin=-10,a.emotionMax=10,a.isDefault=!1,(o=P.value)==null||o.resetFields()};return Z(()=>{C()}),(o,e)=>{const g=i("el-icon"),d=i("el-button"),A=i("el-alert"),p=i("el-table-column"),f=i("el-tag"),L=i("el-button-group"),j=i("el-table"),S=i("el-empty"),G=i("el-card"),z=i("el-input"),v=i("el-form-item"),J=i("el-link"),K=i("el-slider"),O=i("el-switch"),H=i("el-form"),Q=i("el-dialog"),W=ee("loading");return b(),h("div",de,[l(G,{class:"playlists-card"},{header:t(()=>[n("div",ue,[n("div",me,[l(g,{size:24,color:"#409EFF"},{default:t(()=>[l(_(N))]),_:1}),e[7]||(e[7]=n("span",{class:"title"},"音乐歌单管理",-1))]),l(d,{type:"primary",onClick:U,icon:_(se)},{default:t(()=>[...e[8]||(e[8]=[r(" 添加歌单 ",-1)])]),_:1},8,["icon"])])]),default:t(()=>[l(A,{title:"使用说明",type:"info",closable:!1,class:"info-alert"},{default:t(()=>[...e[9]||(e[9]=[n("div",{class:"info-content"},[n("p",null,[r("1. 从网易云音乐网页版打开歌单，复制URL中的ID（如：https://music.163.com/#/playlist?id="),n("b",null,"60198"),r("）")]),n("p",null,"2. 设置情绪范围，系统会根据用户当前情绪自动匹配合适的歌单"),n("p",null,"3. 只能设置一个默认歌单，当情绪不匹配任何范围时使用")],-1)])]),_:1}),le((b(),w(j,{data:D.value,stripe:"",class:"playlists-table"},{default:t(()=>[l(p,{type:"index",label:"#",width:"60"}),l(p,{label:"歌单名称","min-width":"150"},{default:t(({row:s})=>[n("div",pe,[l(g,null,{default:t(()=>[l(_(N))]),_:1}),n("span",null,x(s.name),1),s.isDefault?(b(),w(f,{key:0,type:"warning",size:"small",class:"default-tag"},{default:t(()=>[...e[10]||(e[10]=[r("默认",-1)])]),_:1})):B("",!0)])]),_:1}),l(p,{label:"网易云ID",prop:"neteasePlaylistId",width:"120"}),l(p,{label:"描述",prop:"description","min-width":"200","show-overflow-tooltip":""}),l(p,{label:"情绪范围",width:"150"},{default:t(({row:s})=>[n("div",fe,[l(f,{type:M(s.emotionMin),size:"small"},{default:t(()=>[r(x(s.emotionMin),1)]),_:2},1032,["type"]),e[11]||(e[11]=n("span",{class:"range-separator"},"~",-1)),l(f,{type:M(s.emotionMax),size:"small"},{default:t(()=>[r(x(s.emotionMax),1)]),_:2},1032,["type"])])]),_:1}),l(p,{label:"操作",width:"180",fixed:"right"},{default:t(({row:s})=>[l(L,null,{default:t(()=>[l(d,{type:"primary",size:"small",onClick:X=>F(s),icon:_(te)},{default:t(()=>[...e[12]||(e[12]=[r(" 编辑 ",-1)])]),_:1},8,["onClick","icon"]),l(d,{type:"danger",size:"small",onClick:X=>T(s),icon:_(ae)},{default:t(()=>[...e[13]||(e[13]=[r(" 删除 ",-1)])]),_:1},8,["onClick","icon"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[W,V.value]]),!V.value&&D.value.length===0?(b(),w(S,{key:0,description:"暂无歌单数据"},{default:t(()=>[l(d,{type:"primary",onClick:U},{default:t(()=>[...e[14]||(e[14]=[r("添加第一个歌单",-1)])]),_:1})]),_:1})):B("",!0)]),_:1}),l(Q,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=s=>m.value=s),title:y.value?"编辑歌单":"添加歌单",width:"600px","destroy-on-close":""},{footer:t(()=>[l(d,{onClick:e[5]||(e[5]=s=>m.value=!1)},{default:t(()=>[...e[20]||(e[20]=[r("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:$,loading:I.value},{default:t(()=>[...e[21]||(e[21]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(H,{ref_key:"formRef",ref:P,model:a,rules:R,"label-width":"120px",class:"playlist-form"},{default:t(()=>[l(v,{label:"歌单名称",prop:"name"},{default:t(()=>[l(z,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=s=>a.name=s),placeholder:"如：轻松愉快"},null,8,["modelValue"])]),_:1}),l(v,{label:"网易云ID",prop:"neteasePlaylistId"},{default:t(()=>[l(z,{modelValue:a.neteasePlaylistId,"onUpdate:modelValue":e[1]||(e[1]=s=>a.neteasePlaylistId=s),placeholder:"如：60198"},{append:t(()=>[l(J,{href:"https://music.163.com",target:"_blank",icon:_(oe)},{default:t(()=>[...e[15]||(e[15]=[r("打开网易云",-1)])]),_:1},8,["icon"])]),_:1},8,["modelValue"]),e[16]||(e[16]=n("div",{class:"form-tip"},"从网易云音乐歌单URL中复制ID",-1))]),_:1}),l(v,{label:"描述",prop:"description"},{default:t(()=>[l(z,{modelValue:a.description,"onUpdate:modelValue":e[2]||(e[2]=s=>a.description=s),type:"textarea",rows:2,placeholder:"如：适合心情好的时候"},null,8,["modelValue"])]),_:1}),l(v,{label:"情绪范围",required:""},{default:t(()=>[n("div",ce,[e[17]||(e[17]=n("div",{class:"slider-labels"},[n("span",null,"难过(-10)"),n("span",null,"平静(0)"),n("span",null,"开心(10)")],-1)),l(K,{modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=s=>E.value=s),range:"",min:-10,max:10,marks:{"-10":"-10","-5":"-5",0:"0",5:"5",10:"10"}},null,8,["modelValue"]),n("div",_e,[l(f,{type:M(a.emotionMin)},{default:t(()=>[r("最小: "+x(a.emotionMin),1)]),_:1},8,["type"]),l(f,{type:M(a.emotionMax)},{default:t(()=>[r("最大: "+x(a.emotionMax),1)]),_:1},8,["type"])])])]),_:1}),l(v,{label:"设为默认"},{default:t(()=>[l(O,{modelValue:a.isDefault,"onUpdate:modelValue":e[4]||(e[4]=s=>a.isDefault=s),"active-text":"是","inactive-text":"否"},null,8,["modelValue"]),n("div",ye,[e[19]||(e[19]=r(" 当情绪不匹配任何范围时使用默认歌单 ",-1)),a.isDefault?(b(),w(f,{key:0,type:"warning",size:"small",style:{"margin-left":"8px"}},{default:t(()=>[...e[18]||(e[18]=[r(" 设为默认将取消其他歌单的默认状态 ",-1)])]),_:1})):B("",!0)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},xe=Y(ge,[["__scopeId","data-v-243483e9"]]);export{xe as default};
