import{_ as x,o as V,c as k,a as o,w as a,r,u as b,b as L,d as g,e as I,l as N,f as R,g as u,h as S,E as d,i as _,j as z}from"./index-Q44ybByG.js";const B={class:"login-container"},C={__name:"Login",setup(E){const f=b(),l=_(null),t=_(!1),s=z({username:"",password:""}),w={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少6位",trigger:"blur"}]},c=async()=>{l.value&&await l.value.validate(async m=>{if(m){t.value=!0;try{const e=await S.login(s);console.log("Login response:",e),e.success&&e.data?(localStorage.setItem("admin_token",e.data.token),localStorage.setItem("admin_username",e.data.username),localStorage.setItem("admin_role",e.data.role),d.success("登录成功"),await f.replace("/"),console.log("Navigation completed")):d.error(e.message||"登录失败")}catch(e){console.error("Login error:",e),d.error(e.message||"登录失败")}finally{t.value=!1}}})};return(m,e)=>{const p=r("el-input"),n=r("el-form-item"),v=r("el-button"),y=r("el-form"),h=r("el-card");return V(),k("div",B,[o(h,{class:"login-card",shadow:"hover"},{header:a(()=>[...e[2]||(e[2]=[u("div",{class:"login-header"},[u("h2",null,"LifeOS Admin"),u("p",null,"后台管理系统")],-1)])]),default:a(()=>[o(y,{model:s,rules:w,ref_key:"loginFormRef",ref:l,onKeyup:L(c,["enter"])},{default:a(()=>[o(n,{prop:"username"},{default:a(()=>[o(p,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=i=>s.username=i),placeholder:"用户名","prefix-icon":g(I),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),o(n,{prop:"password"},{default:a(()=>[o(p,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=i=>s.password=i),type:"password",placeholder:"密码","prefix-icon":g(N),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),o(n,null,{default:a(()=>[o(v,{type:"primary",size:"large",loading:t.value,onClick:c,style:{width:"100%"}},{default:a(()=>[...e[3]||(e[3]=[R(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])}}},q=x(C,[["__scopeId","data-v-2ec8c5ac"]]);export{q as default};
